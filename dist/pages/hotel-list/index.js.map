{"version":3,"file":"pages/hotel-list/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AANA;AAOA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAnBA;AAAA;AAAA;AAqBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAKA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;ACxHA;AACA;AACA;AACA;;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://xiecheng-final-work/._src_pages_hotel-list_index.jsx","webpack://xiecheng-final-work/._src_components_HotelCard_index.jsx","webpack://xiecheng-final-work/./src/pages/hotel-list/index.jsx?e695"],"sourcesContent":["import { Component, useState } from 'react'\nimport { View, Text, Input, Button, Checkbox, Icon, ScrollView, Picker, Slider } from '@tarojs/components'\nimport Taro, { useLoad } from '@tarojs/taro';\nimport './index.scss'\nimport HotelCard from '../../components/HotelCard';\nimport IconFont from '../../components/iconfont';\n\nexport default function Index() {\n\n  const [hotelsList, setHotelList] = useState([]);\n  const [loading, setLoading] = useState(true)\n\n  const rangeScore = ['不限评分', '1分以上', '2分以上', '3分以上', '4分以上', '4.5分以上', '5分']\n  const rangeCommentNum = ['不限评价数', '100评论以上', '500评论以上', '1000评论以上', '5000评论以上', '10000评论以上']\n  const rangePrice = ['不限价格', '100元内', '200元内', '400元内', '800元内', '1600元内']\n  var filter = ['不限评分', '不限评价数', '不限价格'] //想要修改后立即刷新页面，仅用useState导致页面刷新后值才修改，所以备份一个可以立即改变值的\n  const [range, setRange] = useState(['不限评分', '不限评价数', '不限价格'])\n  const [searchContent, setSearchContent] = useState('');\n\n  const changeFilter = (index, content) => {\n    filter = [...range]\n    filter[index] = content\n    setRange(filter)\n    refreshHotels()\n  }\n\n  const doSearch = () => {\n    if (searchContent != '') {\n      refreshHotels()\n      console.log(\"do search: \" + searchContent)\n    }\n  }\n  //   hotel: {\n  //     \"_id\": \"00001\",\n  //     \"name\": \"XX酒店(上海大渡河路地铁站店)\",\n  //     \"image\": \"https://pic.imgdb.cn/item/643554db0d2dde5777c63b14.jpg\",\n  //     \"location\": \"长风公园地区|靠近大渡河路地铁站\",\n  //     \"price\": 411.0,\n  //     \"commentNum\": 1229.0,\n  //     \"comment\": [\n  //         \"酒店功能完备\",\n  //         \"酒店装修豪华\"\n  //     ],\n  //     \"score\": 4.9\n  //   }\n  useLoad(async () => {\n    refreshHotels()\n  })\n\n  const getHotels = async () => {\n    setLoading(true)\n    let range = {\n      minScore: parseFloat(filter[0]) ? parseFloat(filter[0]) : 0,//如果NaN，取默认值\n      minCommentNum: parseFloat(filter[1]) ? parseFloat(filter[1]) : 0,\n      maxPrice: parseFloat(filter[2]) ? parseFloat(filter[2]) : 1000000,\n      search: searchContent\n    }\n    console.log(range)\n    const hotels = (await Taro.cloud.callFunction({\n      name: 'get-hotel-list',\n      data: {\n        num: 10,\n        range: range\n      }\n    })).result\n    console.log(hotels)\n    setLoading(false)\n    return hotels\n  }\n\n  const appendHotels = async () => {\n    const result = await getHotels()\n    setHotelList(hotelsList.concat(result))\n  }\n\n  const refreshHotels = async () => {\n    const result = await getHotels()\n    setHotelList(result)\n  }\n\n  return (\n    <View className='hotal-list-page'>\n      <View className='selector'>\n        <View className='filters'>\n          <Picker className='fliter' range={rangeScore} onChange={(e) => {\n            changeFilter(0, rangeScore[e.target.value])\n          }}>\n            <View className='picker-content'>{range[0]}</View>\n          </Picker>\n          <Picker className='fliter' range={rangeCommentNum} onChange={(e) => {\n            changeFilter(1, rangeCommentNum[e.target.value])\n          }}>\n            <View className='picker-content'>{range[1]}</View>\n          </Picker>\n          <Picker className='fliter' range={rangePrice} onChange={(e) => {\n            changeFilter(2, rangePrice[e.target.value])\n          }}>\n            <View className='picker-content'>{range[2]}</View>\n          </Picker>\n        </View>\n        <View className='searcher'>\n          <Input className='search' onInput={(e) => { setSearchContent(e.target.value) }}>12345</Input>\n          <View className='search-icon' onClick={doSearch}>\n            <IconFont name='chazhao' size='50rpx' />\n          </View>\n        </View>\n      </View>\n      <ScrollView className='hotel-cards' scrollY onScrollToLower={(appendHotels)}>\n        {Array.isArray(hotelsList) && hotelsList.map((item) => (\n          <View onClick={() => (Taro.navigateTo({\n            // url: '../comment-submit/index?hotelId=' + item._id + '&hotelName=' + item.name\n            url: '../comment-list/index?hotelId=' + item._id + '&hotelName=' + item.name\n          }))}>\n            <HotelCard hotelDetails={item} />\n          </View>\n        ))}\n        <View className='loading' hidden={loading}>正在加载酒店数据...</View>\n      </ScrollView>\n    </View>\n  )\n}\n","import { View, Image, Text } from '@tarojs/components'\r\nimport { useState } from 'react'\r\nimport './index.scss'\r\nimport StarsScore from '../../components/StarsScore';\r\n\r\n// {/* This is a hotel card, component of hotel list page. */}\r\nexport default function HotelCard({\r\n    hotelDetails\r\n}) {\r\n    return (\r\n        <View className='hotel-card'>\r\n            <View className='card-left'>\r\n                <Image className='hotel-image' src={hotelDetails.image} lazyLoad></Image>\r\n            </View>\r\n            <View className='card-right'>\r\n                <View className='hotel-name'>{hotelDetails.name}</View>\r\n                <View className='comment'>\r\n                    <StarsScore score={hotelDetails.score}></StarsScore>\r\n                    <Text className='comment-score'>{hotelDetails.score.toFixed(1)}分</Text>\r\n                    <Text className='comment-num'>{hotelDetails.commentNum}点评</Text>\r\n                </View>\r\n                <View className='location'>{hotelDetails.location}</View>\r\n                <View className='comment-content'>\"{hotelDetails.comment[Math.floor(Math.random() * hotelDetails.comment.length)]}\"</View>\r\n                <View className='hotel-price'>￥<Text className='cost'>{hotelDetails.price}</Text>起</View>\r\n            </View>\r\n        </View>\r\n    )\r\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js??ruleSet[1].rules[5].use[0]!./index.jsx\"\nvar config = {\"navigationBarTitleText\":\"酒店列表\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/hotel-list/index', {root:{cn:[]}}, config || {}))\n\n\n"],"names":[],"sourceRoot":""}