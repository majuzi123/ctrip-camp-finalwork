{"version":3,"file":"index.js","sources":["../../../src/components/view/index.tsx"],"sourcesContent":["import 'weui'\nimport './style/index.css'\n\nimport classNames from 'classnames'\nimport React from 'react'\n\ninterface IProps extends React.HTMLAttributes<HTMLDivElement> {\n  hoverClass?: string\n  hoverStartTime?: number\n  hoverStayTime?: number\n  onTouchStart?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchEnd?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchMove?(e: React.TouchEvent<HTMLDivElement>): void\n  onLongPress?(): void\n}\n\ninterface IState {\n  hover: boolean\n  touch: boolean\n}\n\nclass View extends React.Component<IProps, IState> {\n  state = {\n    hover: false,\n    touch: false\n  }\n\n  timeoutEvent: ReturnType<typeof setTimeout>\n  startTime = 0\n\n  render () {\n    const {\n      className,\n      hoverClass,\n      onTouchStart,\n      onTouchEnd,\n      onTouchMove,\n      hoverStartTime = 50,\n      hoverStayTime = 400,\n      ...other\n    } = this.props\n\n    const cls = classNames(\n      '',\n      {\n        [`${hoverClass}`]: this.state.hover\n      },\n      className\n    )\n\n    const _onTouchStart = e => {\n      if (hoverClass) {\n        this.setState(() => ({\n          touch: true\n        }))\n        setTimeout(() => {\n          if (this.state.touch) {\n            this.setState(() => ({\n              hover: true\n            }))\n          }\n        }, hoverStartTime)\n      }\n      onTouchStart && onTouchStart(e)\n      if (this.props.onLongPress) {\n        this.timeoutEvent = setTimeout(() => {\n          this.props.onLongPress!()\n        }, 350)\n        this.startTime = new Date().getTime()\n      }\n    }\n\n    const _onTouchMove = e => {\n      clearTimeout(this.timeoutEvent)\n      onTouchMove && onTouchMove(e)\n    }\n\n    const _onTouchEnd = e => {\n      const spanTime = new Date().getTime() - this.startTime\n      if (spanTime < 350) {\n        clearTimeout(this.timeoutEvent)\n      }\n      if (hoverClass) {\n        this.setState(() => ({\n          touch: false\n        }))\n        setTimeout(() => {\n          if (!this.state.touch) {\n            this.setState(() => ({\n              hover: false\n            }))\n          }\n        }, hoverStayTime)\n      }\n      onTouchEnd && onTouchEnd(e)\n    }\n\n    return (\n      <div\n        className={cls}\n        onTouchStart={_onTouchStart}\n        onTouchEnd={_onTouchEnd}\n        onTouchMove={_onTouchMove}\n        {...other}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\nexport default View\n"],"names":["View","state","hover","touch","startTime","_a","props","className","hoverClass","onTouchStart","onTouchEnd","onTouchMove","hoverStartTime","hoverStayTime","other","__rest","cls","classNames","_onTouchStart","e","setState","setTimeout","onLongPress","timeoutEvent","Date","getTime","_onTouchMove","clearTimeout","_onTouchEnd","spanTime","React","createElement","Object","assign","children","Component"],"mappings":"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"}